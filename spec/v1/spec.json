{
  "spec_version": "1.0",
  "name": "Universal Quantum Seed",
  "domain_separator": "universal-seed-v1",
  "compatibility_contract": "v1 seeds MUST always derive the same outputs forever. No parameter may be changed within v1.",

  "seed": {
    "word_counts": [24, 36],
    "data_words": {"24": 22, "36": 34},
    "checksum_words": 2,
    "entropy_bits": {"24": 176, "36": 272},
    "post_quantum_bits": {"24": 88, "36": 136},
    "quantum_safe_minimum": 36,
    "icon_set_size": 256,
    "icon_index_range": [0, 255],
    "bits_per_icon": 8
  },

  "checksum": {
    "algorithm": "HMAC-SHA-256",
    "key": "universal-seed-v1-checksum",
    "key_bytes": 25,
    "message": "data indexes as raw bytes",
    "output": "first 2 bytes of HMAC digest",
    "error_detection_bits": 16,
    "false_positive_rate": "1 in 65536"
  },

  "passphrase": {
    "encoding": "UTF-8",
    "normalization": "NFKC",
    "trimming": false,
    "case_folding": false,
    "empty_equals_none": true
  },

  "kdf_pipeline": {
    "stages": [
      {
        "stage": 0,
        "name": "Checksum Verification & Stripping",
        "description": "Verify last 2 indexes match HMAC-SHA-256 checksum, then strip them"
      },
      {
        "stage": 1,
        "name": "Positional Binding",
        "description": "Pack each data index with its zero-based position as (pos, idx) byte pairs, little-endian"
      },
      {
        "stage": 2,
        "name": "Passphrase Mixing",
        "description": "Append raw UTF-8 passphrase bytes to positional payload"
      },
      {
        "stage": 3,
        "name": "HKDF-Extract",
        "algorithm": "HMAC-SHA-512",
        "key": "universal-seed-v1",
        "key_bytes": 17,
        "message": "positional payload + optional passphrase bytes",
        "output_bytes": 64
      },
      {
        "stage": 4,
        "name": "Chained KDF Stretching",
        "substages": [
          {
            "name": "PBKDF2-SHA-512",
            "salt": "universal-seed-v1-stretch-pbkdf2",
            "salt_bytes": 32,
            "rounds": 600000,
            "dklen": 64
          },
          {
            "name": "Argon2id",
            "salt": "universal-seed-v1-stretch-argon2id",
            "salt_bytes": 34,
            "time_cost": 3,
            "memory_cost_kib": 65536,
            "memory_cost_mib": 64,
            "parallelism": 4,
            "hash_len": 64,
            "type": "Argon2id"
          }
        ]
      },
      {
        "stage": 5,
        "name": "HKDF-Expand",
        "algorithm": "HMAC-SHA-512",
        "info": "universal-seed-v1-master",
        "info_bytes": 24,
        "output_bytes": 64
      }
    ],
    "output": {
      "total_bytes": 64,
      "encryption_key": "first 32 bytes",
      "authentication_key": "last 32 bytes"
    }
  },

  "profiles": {
    "algorithm": "HMAC-SHA-512",
    "key": "master seed (64 bytes)",
    "message_prefix": "universal-seed-v1-profile",
    "message_prefix_bytes": 25,
    "output_bytes": 64,
    "empty_password": "returns master seed unchanged"
  },

  "fingerprint": {
    "length_hex": 8,
    "length_bytes": 4,
    "format": "uppercase hex",
    "without_passphrase": "first 4 bytes of HKDF-Extract PRK",
    "with_passphrase": "first 4 bytes of full KDF output"
  },

  "crypto": {
    "post_quantum": {
      "ml-dsa-65": {
        "standard": "FIPS 204",
        "name": "ML-DSA-65 (Dilithium)",
        "type": "signature",
        "security_level": 3,
        "seed_size": 32,
        "public_key_size": 1952,
        "secret_key_size": 4032,
        "signature_size": 3309,
        "assumption": "Module Learning With Errors (MLWE)",
        "info_prefix": "universal-seed-v1-quantum-ml-dsa-65"
      },
      "slh-dsa-shake-128s": {
        "standard": "FIPS 205",
        "name": "SLH-DSA-SHAKE-128s (SPHINCS+)",
        "type": "signature",
        "security_level": 1,
        "seed_size": 48,
        "public_key_size": 32,
        "secret_key_size": 64,
        "signature_size": 7856,
        "assumption": "Hash-only (SHAKE-256)",
        "info_prefix": "universal-seed-v1-quantum-slh-dsa-shake-128s"
      },
      "ml-kem-768": {
        "standard": "FIPS 203",
        "name": "ML-KEM-768 (Kyber)",
        "type": "key_encapsulation",
        "security_level": 3,
        "seed_size": 64,
        "encapsulation_key_size": 1184,
        "decapsulation_key_size": 2400,
        "ciphertext_size": 1088,
        "shared_secret_size": 32,
        "assumption": "Module Learning With Errors (MLWE)",
        "implicit_rejection": true,
        "info_prefix": "universal-seed-v1-quantum-ml-kem-768"
      }
    },
    "classical": {
      "ed25519": {
        "standard": "RFC 8032",
        "name": "Ed25519",
        "type": "signature",
        "public_key_size": 32,
        "secret_key_size": 64,
        "signature_size": 64,
        "classical_security_bits": 128,
        "note": "Used as component of hybrid-dsa-65, not derived standalone"
      },
      "x25519": {
        "standard": "RFC 7748",
        "name": "X25519",
        "type": "key_exchange",
        "private_key_size": 32,
        "public_key_size": 32,
        "shared_secret_size": 32,
        "classical_security_bits": 128,
        "note": "Used as component of hybrid-kem-768, not derived standalone"
      }
    },
    "hybrid": {
      "hybrid-dsa-65": {
        "name": "Hybrid Ed25519 + ML-DSA-65",
        "type": "signature",
        "composition": "AND (both must verify)",
        "seed_size": 64,
        "public_key_size": 1984,
        "secret_key_size": 4096,
        "signature_size": 3373,
        "context_max_bytes": 241,
        "domain": "hybrid-dsa-v1",
        "stripping_resistance": true,
        "verify_after_sign": true,
        "info_prefix": "universal-seed-v1-quantum-hybrid-dsa-65",
        "components": {
          "classical": "Ed25519 (first 32B of seed)",
          "post_quantum": "ML-DSA-65 (last 32B of seed)"
        }
      },
      "hybrid-kem-768": {
        "name": "Hybrid X25519 + ML-KEM-768",
        "type": "key_encapsulation",
        "seed_size": 96,
        "encapsulation_key_size": 1216,
        "decapsulation_key_size": 2432,
        "ciphertext_size": 1120,
        "shared_secret_size": 32,
        "domain": "hybrid-kem-v1",
        "implicit_rejection": true,
        "info_prefix": "universal-seed-v1-quantum-hybrid-kem-768",
        "secret_combination": {
          "method": "HKDF-SHA256",
          "salt": "SHA-256(x25519_ct || ml_kem_ct)",
          "info": "hybrid-kem-v1 || SHA-256(x25519_pk || ml_kem_ek) || 0x01",
          "ciphertext_binding": true,
          "public_key_binding": true
        },
        "components": {
          "classical": "X25519 (first 32B of seed)",
          "post_quantum": "ML-KEM-768 (last 64B of seed as d||z)"
        }
      }
    },
    "derivation": {
      "method": "HKDF-Expand-SHA-512",
      "info_format": "<info_prefix> + key_index (4 bytes, little-endian uint32)"
    },
    "memory_hardening": {
      "backend": "libsodium (via PyNaCl, optional)",
      "features": ["sodium_mlock", "sodium_memzero", "sodium_munlock"],
      "fallback": "manual byte zeroing"
    }
  },

  "word_resolution": {
    "strict_mode": {
      "used_in": "key derivation",
      "normalization": "NFKC + lowercase",
      "emoji_variation_stripping": true,
      "fuzzy_fallbacks": false
    },
    "fuzzy_mode": {
      "used_in": "UI / recovery",
      "fallbacks": [
        "diacritic stripping (Latin, Greek, Arabic, Hebrew, Cyrillic)",
        "Arabic prefix stripping",
        "Hebrew prefix stripping",
        "French/Italian contraction stripping",
        "Scandinavian/Romanian/Icelandic suffix stripping"
      ]
    }
  }
}
